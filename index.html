<!DOCTYPE html>

<head>
    <script src="node_modules/opencv.js/opencv.js"></script>
    <script src="node_modules/fabric/dist/fabric.js"></script>
    <script src="scripts/grabcut.js"></script>
    <script src="scripts/rectangle.js"></script>
    <script src="scripts/imageInteractivity.js"></script>
    <link rel="stylesheet" href="styles.css">
    <title>Prototype</title>
</head>

<body>
    <h1>Prototype</h1>
    <input type="file" id="file_input">
    <script src="scripts/fileUpload.js"></script>
    <div>
        <strong>Mode:</strong>
        <button onclick="changeButton('rect')">Rectangle</button>
        <button onclick="changeButton('green')">Green Line</button>
        <button onclick="changeButton('red')">Red Line</button>
        <button onclick="changeButton('pan')">Pan</button>
    </div>
    <!-- <div id="preferences">
        <strong>Preferences:</strong>
        <button id="brush width">Brush Width</button>
    </div> -->
    <div>
        <strong>Type:</strong>
        <button onclick="changeLaneType('d')">Dashed</button>
        <button onclick="changeLaneType('s')">Solid</button>
        <button onclick="changeLaneType('r')">Shoulder</button>
        <label for="nLane">Lane Number</label>
        <input type="number" id="nLane">
        <script>
            const changeLaneType = typename => state.lane_specs.lane_type = typename;
            const number = document.getElementById('nLane');
            number.oninput = event => state.lane_specs.lane_number = parseInt(event.target.value);
        </script>
    </div>
    <div>
        <strong>Color:</strong>
        <button onclick="changeLaneColor('w')">White</button>
        <button onclick="changeLaneColor('y')">Yellow</button>
        <script>
            const changeLaneColor = color => state.lane_specs.lane_color = color;
        </script>
    </div>
    <button onclick="toggleImageInteractivity()">Image Interactivity On/Off</button>
    <button id="satisfied" onclick="satisfied()">Satisfied</button>
    <script src="scripts/satisfied.js"></script>
    <script src="scripts/changeButton.js"></script>
    <div id="visuals">
        <div>
            <h2>Input</h2>
            <canvas id="input" class="input"></canvas>
        </div>
        <div>
            <h2>Extracted</h2>
            <canvas id="extracted" class="output"></canvas>
        </div>
        <div>
            <h2>Segmentation</h2>
            <canvas id="segmentation" class="output"></canvas>
        </div>
        <div>
            <h2>Instance</h2>
            <canvas id="instance" class="output"></canvas>
        </div>
    </div>
    <script>
        const state = {
            input_canvas: new fabric.Canvas('input'),
            image_object: null,
            lane_specs: {
                lane_number: 1,
                lane_type: null,
                lane_color: null
            },
            extracted_real: null,
            extracted_plot: null,
            segmentation_real: null,
            segmentation_plot: null,
            instance: null,
            rect_cancelled: false,
            rectangles: [],
            gc_result: {
                mask: null,
                fgd_model: null,
                bgd_model: null,
                fg_points: []
            }
        };
    </script>
</body>

</html>